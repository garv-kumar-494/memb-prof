<!DOCTYPE html>
<html class="light" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Member Profile Setup</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&amp;family=Plus+Jakarta+Sans:wght@400;500;700;800&amp;family=Noto+Sans:wght@400;500;700&amp;display=swap"
        rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#D97706", // Saffron/Amber
                        "primary-dark": "#B45309",
                        "background-light": "#FFFCF5", // Warm cream
                        "background-dark": "#1C1917", // Warm black
                        "surface-light": "#FFFFFF",
                        "surface-dark": "#292524",
                        "border-light": "#FED7AA",
                        "border-dark": "#78350F",
                        "text-main": "#431407", // Deep brown
                        "text-light": "#FFFBEB",
                    },
                    fontFamily: {
                        "display": ["Plus Jakarta Sans", "sans-serif"],
                        "serif": ["Playfair Display", "serif"],
                        "body": ["Noto Sans", "sans-serif"],
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "2xl": "1rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 24
        }

        ::-webkit-scrollbar {
            width: 0px;
            background: transparent;
        }

        .theme-pattern {
            background-color: transparent;
            background-image: radial-gradient(#F59E0B 0.5px, transparent 0.5px), radial-gradient(#F59E0B 0.5px, transparent 0.5px);
            background-size: 24px 24px;
            background-position: 0 0, 12px 12px;
            opacity: 0.15;
        }

        .dark .theme-pattern {
            background-image: radial-gradient(#92400E 0.5px, transparent 0.5px), radial-gradient(#92400E 0.5px, transparent 0.5px);
            opacity: 0.25;
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark antialiased font-display min-h-screen flex flex-col selection:bg-primary/30">
    <div class="fixed inset-0 theme-pattern pointer-events-none z-0"></div>
    <header
        class="flex items-center justify-between p-4 pb-2 sticky top-0 bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm z-10 transition-colors">
        <button
            class="flex size-10 items-center justify-center rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition-colors">
            <span class="material-symbols-outlined text-text-main dark:text-text-light"
                data-icon="chevron_left">chevron_left</span>
        </button>
        <div class="flex flex-col items-center flex-1 mx-4">
            <span class="text-primary-dark dark:text-[#fde68a] text-xs font-bold tracking-widest uppercase">Profile
                Setup</span>
            <div class="w-full max-w-[120px] h-1.5 bg-orange-100 dark:bg-stone-800 rounded-full mt-2 overflow-hidden">
                <div class="h-full bg-gradient-to-r from-primary to-primary-dark w-1/3 rounded-full"></div>
            </div>
        </div>
        <div class="size-10 flex items-center justify-center">
            <span class="material-symbols-outlined text-primary/60 dark:text-primary/80">local_florist</span>
        </div>
    </header>
    <main class="flex-1 flex flex-col px-6 pt-6 pb-32 overflow-y-auto z-10 relative">
        <div class="mb-8">
            <h1
                class="text-text-main dark:text-text-light text-4xl font-serif font-bold leading-tight tracking-tight mb-4">
                Hari Om! <br /> Let's know you better
            </h1>
            <p class="text-[#78350f] dark:text-[#fde68a]/80 text-base font-body font-normal leading-relaxed">
                Please provide your details to join our community. Your affiliated temple will verify your membership.
            </p>
        </div>
        <div class="space-y-6">
            <div class="flex flex-col gap-2 group">
                <label class="text-text-main dark:text-[#fde68a] text-sm font-bold uppercase tracking-wide ml-1"
                    for="fullname">
                    Full Name
                </label>
                <div class="relative">
                    <input
                        class="form-input flex w-full rounded-2xl border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark h-14 pl-12 pr-4 text-lg text-text-main dark:text-text-light placeholder-[#9a3412]/40 dark:placeholder-[#fde68a]/30 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-sm group-hover:shadow-md"
                        id="fullname" placeholder="Enter your full legal name" type="text" />
                    <span
                        class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-primary dark:text-[#d97706] pointer-events-none">person</span>
                </div>
            </div>
            <div class="flex flex-col gap-2 group">
                <div class="flex justify-between items-baseline">
                    <label class="text-text-main dark:text-[#fde68a] text-sm font-bold uppercase tracking-wide ml-1"
                        for="temple">
                        Affiliated Temple
                    </label>
                </div>
                <div class="relative">
                    <input
                        class="form-input flex w-full rounded-2xl border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark h-14 pl-12 pr-4 text-lg text-text-main dark:text-text-light placeholder-[#9a3412]/40 dark:placeholder-[#fde68a]/30 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-sm group-hover:shadow-md"
                        id="temple" placeholder="Search your home temple" type="text" />
                    <span
                        class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-primary dark:text-[#d97706] pointer-events-none">temple_hindu</span>

                    <div id="templeDropdown"
                        class="absolute top-full left-0 right-0 mt-2 bg-white dark:bg-[#292524] border border-border-light dark:border-border-dark rounded-xl shadow-xl max-h-60 overflow-y-auto hidden z-50">
                    </div>

                </div>
                <div
                    class="flex gap-3 bg-orange-50 dark:bg-[#451a03]/40 p-3.5 rounded-xl border border-orange-100 dark:border-[#92400E] mt-1">
                    <span class="material-symbols-outlined text-primary shrink-0 mt-0.5 text-[20px]">lock_clock</span>
                    <div class="flex flex-col">
                        <h4 class="text-primary-dark dark:text-[#f59e0b] font-bold text-sm mb-0.5 font-display">
                            Selection will be locked</h4>
                        <p class="text-[#7c2d12] dark:text-[#fcd34d]/80 text-xs leading-relaxed font-body">
                            Once submitted and approved by the admin, you cannot change your temple affiliation.
                        </p>
                    </div>
                </div>
            </div>
            <div class="flex flex-col gap-2 group">
                <label class="text-text-main dark:text-[#fde68a] text-sm font-bold uppercase tracking-wide ml-1"
                    for="phone">
                    Phone Number
                </label>
                <div class="relative">
                    <input
                        class="form-input flex w-full rounded-2xl border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark h-14 pl-12 pr-4 text-lg text-text-main dark:text-text-light placeholder-[#9a3412]/40 dark:placeholder-[#fde68a]/30 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-sm group-hover:shadow-md"
                        id="phone" placeholder="+91 1122334455" type="tel" value="+91" />
                    <span
                        class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-primary dark:text-[#d97706] pointer-events-none">call</span>
                </div>
                                <p id="phoneError" class="text-red-600 dark:text-red-400 text-xs ml-1 hidden">Please enter a valid 10-digit phone number</p>

            </div>
            <div class="flex flex-col gap-2 group">
                <label class="text-text-main dark:text-[#fde68a] text-sm font-bold uppercase tracking-wide ml-1"
                    for="email">
                    Gmail Address
                </label>
                <div class="relative">
                    <input
                        class="form-input flex w-full rounded-2xl border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark h-14 pl-12 pr-4 text-lg text-text-main dark:text-text-light placeholder-[#9a3412]/40 dark:placeholder-[#fde68a]/30 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-sm group-hover:shadow-md"
                        id="email" placeholder="yourname@gmail.com" type="email" />
                    <span
                        class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-primary dark:text-[#d97706] pointer-events-none">mail</span>
                </div>
                                <p id="emailError" class="text-red-600 dark:text-red-400 text-xs ml-1 hidden">Please enter a valid email address</p>

            </div>
            <div class="flex flex-col gap-2 group">
                <label class="text-text-main dark:text-[#fde68a] text-sm font-bold uppercase tracking-wide ml-1"
                    for="password">
                    Password
                </label>
                <div class="relative">
                    <input
                        class="form-input flex w-full rounded-2xl border border-border-light dark:border-border-dark bg-surface-light dark:bg-surface-dark h-14 pl-12 pr-4 text-lg text-text-main dark:text-text-light placeholder-[#9a3412]/40 dark:placeholder-[#fde68a]/30 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all shadow-sm group-hover:shadow-md"
                        id="password" placeholder="Your Password" type="password" />
                    <span
                        class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-primary dark:text-[#d97706] pointer-events-none">password</span>
                </div>
            </div>
        </div>
    </main>
    <div
        class="fixed bottom-0 left-0 w-full bg-background-light/90 dark:bg-background-dark/90 backdrop-blur-md p-6 border-t border-border-light/40 dark:border-border-dark/40 z-20">
        <button id="saveBtn"
            class="w-full h-14 bg-gradient-to-r from-[#ea580c] to-[#d97706] hover:from-[#c2410c] hover:to-[#b45309] active:scale-[0.98] transition-all rounded-full text-white text-lg font-bold font-display shadow-lg shadow-orange-500/30 flex items-center justify-center gap-2">
            Save & Continue
            <span class="material-symbols-outlined">arrow_forward</span>
        </button>

        <p class="text-center mt-4 text-xs text-[#9a3412]/60 dark:text-[#fcd34d]/50 font-medium">
            By continuing, you agree to our <a class="underline hover:text-primary" href="#">Terms</a> and <a
                class="underline hover:text-primary" href="#">Privacy Policy</a>.
        </p>
    </div>

</body>



<script>
    // ðŸ”¹ Phone Number Validation
    const phoneInput = document.getElementById("phone");
    const phoneError = document.getElementById("phoneError");

    phoneInput.addEventListener("input", function(e) {
        let value = e.target.value;
        
        // Always maintain +91 prefix
        if (!value.startsWith("+91 ")) {
            value = "+91 ";
        }
        
        // Remove any non-digit characters after +91 
        const digitsOnly = value.slice(4).replace(/\D/g, "");
        
        // Limit to exactly 10 digits
        const limitedDigits = digitsOnly.slice(0, 10);
        
        // Set the formatted value
        e.target.value = "+91 " + limitedDigits;
        
        // Validate - show error only if there are digits but less than 10
        if (limitedDigits.length > 0 && limitedDigits.length < 10) {
            phoneError.classList.remove("hidden");
        } else {
            phoneError.classList.add("hidden");
        }
    });

    // Prevent deletion of +91 prefix
    phoneInput.addEventListener("keydown", function(e) {
        const cursorPosition = e.target.selectionStart;
        
        // Prevent backspace/delete if it would remove the prefix
        if ((e.key === "Backspace" || e.key === "Delete") && cursorPosition <= 4) {
            e.preventDefault();
        }
    });

    // Prevent cursor from moving before +91
    phoneInput.addEventListener("click", function(e) {
        if (e.target.selectionStart < 4) {
            e.target.setSelectionRange(4, 4);
        }
    });

    // ðŸ”¹ Email Validation
    const emailInput = document.getElementById("email");
    const emailError = document.getElementById("emailError");

    function validateEmail(email) {
        // Comprehensive email regex pattern
        const emailRegex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
        return emailRegex.test(email);
    }

    emailInput.addEventListener("blur", function(e) {
        const email = e.target.value.trim();
        
        if (email && !validateEmail(email)) {
            emailError.classList.remove("hidden");
            emailInput.classList.add("border-red-500");
        } else {
            emailError.classList.add("hidden");
            emailInput.classList.remove("border-red-500");
        }
    });

    emailInput.addEventListener("input", function(e) {
        // Clear error on input
        if (validateEmail(e.target.value.trim())) {
            emailError.classList.add("hidden");
            emailInput.classList.remove("border-red-500");
        }
    });
</script>

<script>
    const templeInput = document.getElementById("temple");
    const dropdown = document.getElementById("templeDropdown");
    let temples = [];

    // ðŸ”¹ Fetch temples
    async function fetchTemples() {
        const res = await fetch("https://memb-prof-1000.onrender.com/api/temples");
        const data = await res.json();
        temples = data.data || [];
    }

    // ðŸ”¹ Render dropdown
    function renderDropdown(list) {
        dropdown.innerHTML = "";

        if (list.length === 0) {
            dropdown.innerHTML = `
      <div class="px-4 py-3 text-sm text-gray-500">
        No temples found
      </div>`;
            dropdown.classList.remove("hidden");
            return;
        }

        list.forEach(t => {
            const div = document.createElement("div");
            div.className =
                "px-4 py-3 cursor-pointer hover:bg-orange-50 dark:hover:bg-[#451a03] transition";

            div.innerHTML = `
      <div class="font-semibold">${t.templeName}</div>
      <div class="text-xs opacity-70">${t.templeLocation}, ${t.templeState}</div>
    `;

            div.onclick = () => {
                templeInput.value = t.templeName;
                dropdown.classList.add("hidden");
            };

            dropdown.appendChild(div);
        });

        dropdown.classList.remove("hidden");
    }

    // ðŸ”¹ Events
    templeInput.addEventListener("focus", () => renderDropdown(temples));

    templeInput.addEventListener("input", () => {
        const v = templeInput.value.toLowerCase();
        renderDropdown(
            temples.filter(t => t.templeName.toLowerCase().includes(v))
        );
    });

    // ðŸ”¹ Close on outside click
    document.addEventListener("click", e => {
        if (!e.target.closest("#temple") && !e.target.closest("#templeDropdown")) {
            dropdown.classList.add("hidden");
        }
    });

    fetchTemples();
</script>









<script>
    document.getElementById("saveBtn").addEventListener("click", async () => {
        const name = document.getElementById("fullname").value;
        const phone = document.getElementById("phone").value;
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const temple = document.getElementById("temple").value;

        if (!name || !phone || !email || !password || !temple) {
            alert("Fill all details");
            return;
        }



 // Validate phone number (must be exactly +91 followed by 10 digits)
        const phoneDigits = phone.slice(4).replace(/\D/g, "");
        if (phoneDigits.length !== 10) {
            alert("Please enter a valid 10-digit phone number");
            phoneError.classList.remove("hidden");
            return;
        }





   // Validate email format
        if (!validateEmail(email)) {
            alert("Please enter a valid email address");
            emailError.classList.remove("hidden");
            emailInput.classList.add("border-red-500");
            return;
        }



        const res = await fetch("https://memb-prof-1000.onrender.com/save", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, phone, email, password, temple }),
        });

        const data = await res.json();

        if (res.ok) {
            // Store the user's name in local storage
            localStorage.setItem('userName', name);
            localStorage.setItem('userEmail', email);
            localStorage.setItem('userTemple', temple);
            localStorage.setItem('userPhone', phone);
            localStorage.setItem('userPassword', password);


            // âœ… SUCCESS â†’ NEXT PAGE
            window.location.href = "doc-verify.html";
        } else {
            alert(data.message || "Something went wrong");
        }
    });
</script>


</html>